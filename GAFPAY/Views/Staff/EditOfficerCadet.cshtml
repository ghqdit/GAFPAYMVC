@model GAFPAY.ViewModel.OfficerCadet
@{
    ViewBag.Title = "Edit Officer Cadet";
}


<div class="page-header">
    <h3 class="page-title"> @ViewBag.Title </h3>
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">

            <li class="breadcrumb-item"> <a href="@Url.Action("Index","Home")"> Dashboard</a> </li>
            <li class="breadcrumb-item"> <a href="@Url.Action("IndexOfficerCadet","Staff")"> Officer Cadet </a> </li>
            <li class="breadcrumb-item active" aria-current="page">@ViewBag.Title</li>
        </ol>
    </nav>
</div>

<div class="main-page">
    <div class="row">
        <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
                <div class="card-body">

                    @using (Html.BeginForm("", "", FormMethod.Post, new { @class = "form-horizontal", role = "form", enctype = "multipart/form-data", id = "NewFormX" }))
                    {
                        @Html.AntiForgeryToken()
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                        <div class="row">
                            <div class="col-md-3 offset-1">
                                <div class="card card-user">
                                    <br /><br />
                                    <div class="content">
                                        <div class="author">

                                            <h4>Officer Cadet Picture</h4>

                                            @if (Model.ImageName == null)
                                            {

                                                <img src="~/Content/pictures/OfficerCadet/default.jpg" alt="Alternate Pic" id="OfficerCadetPic" height="200" width="200" />
                                            }
                                            else
                                            {
                                                <img src="~/Content/pictures/OfficerCadet/@Model.ImageName " alt="Alternate Text" id="OfficerCadetPic" height="200" width="200" />

                                            }

                                            <br /><br />
                                            <input type="file" name="ImageUpload" onchange="readURL(this);">
                                        </div>

                                    </div>
                                    <hr>
                                </div>

                            </div>
                            <div class="col-md-8 " id="" style="">
                                <div class="row">

                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.Surname)
                                            @Html.EditorFor(model => model.Surname, new { htmlAttributes = new { @class = "form-control", placeholder = "Surname" } })

                                        </div>
                                    </div>

                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.Othername)
                                            @Html.EditorFor(model => model.Othername, new { htmlAttributes = new { @class = "form-control", placeholder = "Other Name" } })

                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.GenderID)
                                            @Html.DropDownListFor(model => model.GenderID, Model.GenderList, "Select Gender", htmlAttributes: new { @class = "form-control" })

                                        </div>
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.DOB)
                                            <input type="text" id="DOB" name="DOB" readonly="readonly" class="form-control" value="@Model.DOB" />

                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.ServiceNumber)
                                            <input type="number" id="ServiceNumber" name="ServiceNumber" class="form-control" value="@Model.ServiceNumber" />

                                        </div>
                                    </div>

                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.ReligionID)
                                            @Html.DropDownListFor(model => model.ReligionID, Model.ReligionList, "Select Religion", htmlAttributes: new { @class = "form-control" })

                                        </div>
                                    </div>


                                </div>
                                <br />

                                <div class="row">

                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.PhoneNumber)
                                            <input type="number" id="PhoneNumber" name="PhoneNumber" class="form-control PhoneNumber" value="@Model.PhoneNumber" />

                                        </div>
                                    </div>

                                    <div class="col-sm-8">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.EmailAddress)
                                            @Html.EditorFor(model => model.EmailAddress, new { htmlAttributes = new { @class = "form-control", placeholder = "Email Address" } })

                                        </div>

                                    </div>

                                </div>
                                <br />


                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.RegionID)
                                            @Html.DropDownListFor(model => model.RegionID, Model.RegionList, "Select Home Region", htmlAttributes: new { @class = "form-control" })

                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.Hometown)
                                            @Html.EditorFor(model => model.Hometown, new { htmlAttributes = new { @class = "form-control", placeholder = "Hometown" } })

                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.BloodGroupID)
                                            @Html.DropDownListFor(model => model.BloodGroupID, Model.BloodGroupList, "Select Blood Group", htmlAttributes: new { @class = "form-control" })

                                        </div>
                                    </div>
                                </div>
                                <br />

                                <div class="row">
                                    <div class="col-sm-8">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.ResAddress)
                                            @Html.EditorFor(model => model.ResAddress, new { htmlAttributes = new { @class = "form-control", placeholder = "Residential Address" } })

                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.GeneralStatusID)
                                            @Html.DropDownListFor(model => model.GeneralStatusID, Model.GeneralStatusList, "Select Status", htmlAttributes: new { @class = "form-control" })

                                        </div>
                                    </div>
                                </div>
                                <br/>

                                <div class="row">

                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.ServiceID)
                                            @Html.DropDownListFor(model => model.ServiceID, Model.ServiceList, "Select Service", htmlAttributes: new { @class = "form-control",@disabled= "disabled" })

                                        </div>
                                    </div>

                                    <div class="col-sm-4">
                                        <div class="input-field">
                                            @Html.LabelFor(model => model.RankID)
                                            @Html.DropDownListFor(model => model.RankID, Model.RankList, "Select Rank", htmlAttributes: new { @class = "form-control" })

                                        </div>
                                    </div>
                                </div>
                                <br />


                            </div>
                        </div>

                        <br />
                        <br />
                        <br />

                        <div class="row">
                            <div class="col-md-2 offset-md-10">

                                <a class="btn btn-lg btn-primary pull-right" id="" onclick="sendForm()" style="color: white;background-color:blue;">Save</a>

                            </div>

                        </div>

                    }
                </div>
            </div>
        </div>

    </div>
</div>
<script>

    $(document).on("keypress keyup blur", '.PhoneNumber', function (event) {
        $(this).val($(this).val().replace(/[^0-9]/g, ''));
        if (event.which != 8 && (event.which < 48 || event.which > 57)) {
            event.preventDefault();
        }
    });



    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#OfficerCadetPic')
                    .attr('src', e.target.result)
                    .width(250)
                    .height(250);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    $(function () {
        $("#DOB").datepicker({
            dateFormat: 'dd-MM-yy',
            maxDate: 0,
            autoclose: true,
            changeMonth: true,
            changeYear: true
        });
    });





    function sendForm() {

        var form = $('#NewFormX').get(0);

        $.ajax({
            url: "@Url.Action("EditOfficerCadet", "Staff")",
            type: "POST",
            data: new FormData(form),
            processData: false,
            contentType: false,

            success: function (data) {
                if (data.Success) {
                    swal({
                        title: "Success",
                        html: data.Message + " saved successfully",
                        type: "success",
                        showCancelButton: false,
                        confirmButtonColor: "#1E90FF",
                        confirmButtonText: "OK",
                        timer: 4000,

                    }).then((result) => {
                        //redirection happens here
                        window.location.href = '@Url.Action("IndexOfficerCadet", "Staff")';
                    })

                } else {
                    var error;
                    if (data.ErrorMessage) {
                        error = data.ErrorMessage;
                    }
                    else {
                        error = "Error while processing. Please try again";
                    }
                    swal("Error", error, "error");
                    //swal("error", "error");
                }

            }
        });
    }


</script>